%% ----------------------------------------------------------------------------
% BIWI SA/MA thesis template
%
% Created 09/29/2006 by Andreas Ess
% Extended 13/02/2009 by Jan Lesniak - jlesniak@vision.ee.ethz.ch
%% ----------------------------------------------------------------------------
\newpage
\chapter{Experiments and Results}
This section explains about experimental setup to test the optimization methods/algorithm and the results obtained for them. The estimation methods are tested for different datasets. The methods are tested initially for synthetic images generated using IFGT. The use of synthetic dataset provides a controlled enviroment in which effect of different paraemters can be tested. The image in figure NUMBER is projection of stack of images on x,y,z axis, synthesized using using point source with intensity, 1000 located in object space at [10, 12, 20] and SNR=100. The PSF is generated using 2 Gaussians centred at [-2,-2,0] and  [2,2,0], both with $\sigma_xy$ as 1.5 and $\sigma_z$ as 2.5 and combined with weights of 0.4 and 0.6. The image is of size, 40x25x20 i.e. stacks=40, height=25 and width=20.
\begin{figure}[h!] \label{fig:results}
\begin{tabular}{cc}
 \includegraphics[width=0.65\linewidth]{figures/img_stack.pdf} & \includegraphics[width=0.35\linewidth]{figures/est_wts.pdf} \\
  a) Input, reconstructed and residual image,  & b) Comparison of PSF model\\
\end{tabular}
\caption{Visualization and comparison of results}
\end{figure}

A \textbf{dictionary} containing 64 mean positions including the above centres was used to estimate weights. The estimated weights and estimated image are shown in figure NUMBER. If the PSF model for input images is known, the performance can be measured as difference from the original PSF model, else it can be measured as residual image i.e. difference between input image and image synthesized using estimated PSF. The error can be calculated as absolute sum of residual i.e. $\mathbf{L}$-1 norm, or sum of square of residuals i.e. $\mathbf{L}$-2 norm, or the maximimum i.e. $\mathbf{L}$-$\infty$ norm.

\section{CMA-ES vs ADMM}
For synthetic images generated as explained above, the optimal weights can be obtained by optimizing equation~\ref{eq:nll_ng}. The equation is optimized using \textit{CMA-ES} and ADMM, considering source position to be known. A \textbf{dictionary} is created with different kernel sizes containing actual centres and fed to to both algorithms. The regularisation parameter in the equation, $\lambda$ is also modified to compare the speed and accuracy for both algorithms. The error is calculated as difference in the PSF model i.e. difference of true weights and estimated weights. The plots for error and time for $\lambda$=1, 10 are shown in figure NUMBER.
\begin{figure}[h!] \label{fig:cmaAdmm}
\begin{tabular}{cc}
 \includegraphics[width=1.0\linewidth]{figures/err_time_lamda1.pdf} \\
 \includegraphics[width=1.0\linewidth]{figures/err_time_lamda10.pdf} \\
\end{tabular}
\caption{Comparison of error and speed for CMA-ES and ADMM for $lambda$=1, 10}
\end{figure}
The error results tends to coincide with increase in number of kernels, but there is sharp increase in time taken by \textit{CMA-ES} in comparison to that taken by ADMM. Due to this reason, we can not use \textit{CMA-ES} for huge dictionary sizes. The algorithm designed using ADMM produces satisfactory results with in limited time. Next we can visualize the effect of SNR and regularisation parameter, $\lambda$, for ADMM.
\subsection{Effect on results for ADMM}
The estimation of PSF uses observed data to calculate $nll$ and thus, quality of observed data is crucial for better results. We observe this effect for synthetic data generated using multiple Gaussian with different centres and covariances. The \textbf{dictionary} used contains 100 kernels, including the kernels used for generating image. We do not try to estimate source parameters for now, to have direct effect of the variations of SNR on estimated weights. The other parameter that effects the performance of ADMM is the regularization parameter. The estimated weights of PSF model are shown for different SNR for different $\lambda$ below in figure NUMBER. The plots in each row correspond to $\lambda$ as 0.1, 1, 10, 100. The plots in each column correspond to SNR as 10, 20, 40, 100. 
\begin{figure}[h!] \label{fig:snrlamda}
\begin{tabular}{cc}
 \includegraphics[width=1.0\linewidth]{figures/snr_lamda_effect.pdf} 
\end{tabular}
\caption{Weights for different SNR and $\lambda$}
\end{figure}
It can be observed that as SNR is increased, the estimated weights come closer to true weights. 


\subsection{Improvent in results by pruning dictionary}

\section{Estimation results for synthetic data generated using gaussian psf}
\subsection{Use of single gaussian}
\subsection{Use of multiple gaussian}
\subsection{comparison of results}
\section{Estimation results for synthetic data generated using non-gaussian psf}
dictinary design.
\section{Estimation results for real data}




Describe the evaluation you did in a way, such that an independent researcher can repeat it. Cover the following questions:
\begin{itemize}
 \item \textit{What is the experimental setup and methodology?} Describe the setting of the experiments and give all the parameters in detail which you have used. Give a detailed account of how the experiment was conducted.
 \item \textit{What are your results?} In this section, a \emph{clear description} of the results is given. If you produced lots of data, include only representative data here and put all results into the appendix. 
\end{itemize}
